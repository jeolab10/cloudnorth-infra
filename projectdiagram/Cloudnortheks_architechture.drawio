<mxfile host="app.diagrams.net">
  <diagram id="cloudnorth-eks-layout" name="CloudNorth EKS Layout">
    <mxGraphModel dx="827" dy="570" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- AWS Region -->
        <mxCell id="region" value="AWS Region: eu-west-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="1100" height="700" as="geometry"/>
        </mxCell>

        <!-- VPC -->
        <mxCell id="vpc" value="CloudNorth VPC (10.0.0.0/16)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="region">
          <mxGeometry x="40" y="50" width="1050" height="640" as="geometry"/>
        </mxCell>

        <!-- Public Subnet -->
        <mxCell id="publicSubnet" value="Public Subnet (10.0.1.0/24)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="vpc">
          <mxGeometry x="60" y="80" width="450" height="260" as="geometry"/>
        </mxCell>

        <!-- Private Subnet -->
        <mxCell id="privateSubnet" value="Private Subnet (10.0.2.0/24)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="vpc">
          <mxGeometry x="530" y="80" width="520" height="520" as="geometry"/>
        </mxCell>

        <!-- Internet / Users -->
        <mxCell id="users" value="Users / Internet" style="shape=cloud;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;" vertex="1" parent="region">
          <mxGeometry x="80" y="40" width="120" height="60" as="geometry"/>
        </mxCell>

        <!-- ALB / Ingress -->
        <mxCell id="alb" value="ALB / Ingress" style="shape=mxgraph.aws.network.application_load_balancer;whiteSpace=wrap;html=1;" vertex="1" parent="publicSubnet">
          <mxGeometry x="170" y="110" width="70" height="70" as="geometry"/>
        </mxCell>

        <!-- EKS Cluster Group -->
        <mxCell id="eksClusterGroup" value="EKS Cluster: cloudnorth-eks" style="swimlane;childLayout=stackLayout;horizontal=1;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=0;rounded=1;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=1;" vertex="1" parent="privateSubnet">
          <mxGeometry x="40" y="100" width="440" height="380" as="geometry"/>
        </mxCell>

        <!-- EKS Cluster Icon -->
        <mxCell id="eksClusterIcon" value="EKS Control Plane (Managed)" style="shape=mxgraph.aws.containers.eks;whiteSpace=wrap;html=1;" vertex="1" parent="eksClusterGroup">
          <mxGeometry x="20" y="40" width="90" height="60" as="geometry"/>
        </mxCell>

        <!-- Node Group -->
        <mxCell id="nodeGroup" value="Managed Node Group (t3.medium x 2)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="eksClusterGroup">
          <mxGeometry x="140" y="40" width="260" height="80" as="geometry"/>
        </mxCell>

        <!-- Worker Node 1 -->
        <mxCell id="worker1" value="Worker Node 1" style="shape=mxgraph.aws.compute.ec2_instance;whiteSpace=wrap;html=1;" vertex="1" parent="nodeGroup">
          <mxGeometry x="10" y="30" width="60" height="50" as="geometry"/>
        </mxCell>

        <!-- Worker Node 2 -->
        <mxCell id="worker2" value="Worker Node 2" style="shape=mxgraph.aws.compute.ec2_instance;whiteSpace=wrap;html=1;" vertex="1" parent="nodeGroup">
          <mxGeometry x="110" y="30" width="60" height="50" as="geometry"/>
        </mxCell>

        <!-- Pods Group -->
        <mxCell id="podsGroup" value="Pods in cloudnorth namespace" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#029be5;" vertex="1" parent="eksClusterGroup">
          <mxGeometry x="40" y="150" width="380" height="200" as="geometry"/>
        </mxCell>

        <!-- Frontend Pod -->
        <mxCell id="frontendPod" value="Deployment: frontend&#10;Replicas: 2" style="shape=ellipse;whiteSpace=wrap;html=1;fillColor=#cfe2f3;strokeColor=#6d9eeb;" vertex="1" parent="podsGroup">
          <mxGeometry x="40" y="40" width="120" height="70" as="geometry"/>
        </mxCell>

        <!-- Backend Pod -->
        <mxCell id="backendPod" value="Deployment: backend&#10;Replicas: 2" style="shape=ellipse;whiteSpace=wrap;html=1;fillColor=#f4cccc;strokeColor=#cc0000;" vertex="1" parent="podsGroup">
          <mxGeometry x="210" y="40" width="120" height="70" as="geometry"/>
        </mxCell>

        <!-- Frontend Service -->
        <mxCell id="frontendSvc" value="Service: frontend&#10;Type: ClusterIP&#10;Port: 80" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d9ead3;strokeColor=#38761d;" vertex="1" parent="podsGroup">
          <mxGeometry x="60" y="130" width="120" height="60" as="geometry"/>
        </mxCell>

        <!-- Backend Service -->
        <mxCell id="backendSvc" value="Service: backend&#10;Type: ClusterIP&#10;Port: 3000" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce5cd;strokeColor=#e69138;" vertex="1" parent="podsGroup">
          <mxGeometry x="220" y="130" width="120" height="60" as="geometry"/>
        </mxCell>

        <!-- ECR Registry -->
        <mxCell id="ecr" value="ECR:&#10;cloudnorth-frontend&#10;cloudnorth-backend" style="shape=mxgraph.aws.compute.registry;whiteSpace=wrap;html=1;" vertex="1" parent="region">
          <mxGeometry x="80" y="360" width="140" height="80" as="geometry"/>
        </mxCell>

        <!-- GitHub / CI -->
        <mxCell id="github" value="GitHub Actions&#10;CI/CD Pipeline" style="shape=mxgraph.cisco.servers;whiteSpace=wrap;html=1;" vertex="1" parent="region">
          <mxGeometry x="80" y="460" width="140" height="70" as="geometry"/>
        </mxCell>

        <!-- CloudWatch -->
        <mxCell id="cloudwatch" value="CloudWatch&#10;Container Insights" style="shape=mxgraph.aws.management.cloudwatch;whiteSpace=wrap;html=1;" vertex="1" parent="region">
          <mxGeometry x="900" y="360" width="80" height="70" as="geometry"/>
        </mxCell>

        <!-- Prometheus -->
        <mxCell id="prometheus" value="Prometheus&#10;(in-cluster)" style="shape=mxgraph.c4.monitoring;whiteSpace=wrap;html=1;" vertex="1" parent="region">
          <mxGeometry x="880" y="460" width="80" height="70" as="geometry"/>
        </mxCell>

        <!-- Grafana -->
        <mxCell id="grafana" value="Grafana&#10;Dashboards" style="shape=mxgraph.c4.monitoring;whiteSpace=wrap;html=1;" vertex="1" parent="region">
          <mxGeometry x="980" y="460" width="80" height="70" as="geometry"/>
        </mxCell>

        <!-- Connections -->

        <!-- Users -> ALB -->
        <mxCell id="edgeUsersAlb" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" edge="1" parent="region" source="users" target="alb">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- ALB -> Frontend Service -->
        <mxCell id="edgeAlbFrontendSvc" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" edge="1" parent="region" source="alb" target="frontendSvc">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Frontend Service -> Frontend Pods -->
        <mxCell id="edgeFrontendSvcPod" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=block;endFill=1;" edge="1" parent="region" source="frontendSvc" target="frontendPod">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Backend Service -> Backend Pods -->
        <mxCell id="edgeBackendSvcPod" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=block;endFill=1;" edge="1" parent="region" source="backendSvc" target="backendPod">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Frontend Pods -> Backend Service -->
        <mxCell id="edgeFrontendToBackendSvc" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" edge="1" parent="region" source="frontendPod" target="backendSvc">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- GitHub -> ECR -->
        <mxCell id="edgeGithubEcr" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" edge="1" parent="region" source="github" target="ecr">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- ECR -> EKS Cluster -->
        <mxCell id="edgeEcrEks" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" edge="1" parent="region" source="ecr" target="eksClusterGroup">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- EKS -> CloudWatch -->
        <mxCell id="edgeEksCloudwatch" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=block;endFill=1;" edge="1" parent="region" source="eksClusterGroup" target="cloudwatch">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- EKS -> Prometheus -->
        <mxCell id="edgeEksPrometheus" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;endArrow=block;endFill=1;" edge="1" parent="region" source="eksClusterGroup" target="prometheus">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Prometheus -> Grafana -->
        <mxCell id="edgePrometheusGrafana" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" edge="1" parent="region" source="prometheus" target="grafana">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>